name: Check monthly DLUO and send it to Notion
on:
  # schedule:
  # Tous les 1ers du mois Ã  00:00 UTC
  # - cron: '0 0 1 * *'
  workflow_dispatch: # permet aussi de dÃ©clencher manuellement si besoin

jobs:
  create-notion-card:
    runs-on: ubuntu-22.04
    steps:
      - name: Create Notion card
        run: |
          curl -X POST "https://api.notion.com/v1/pages" \
          -H "Authorization: Bearer ${{ secrets.NOTION_API_KEY }}" \
          -H "Content-Type: application/json" \
          -H "Notion-Version: 2022-06-28" \
          --data '{
            "parent": { "database_id": "'"${{ secrets.NOTION_DATABASE }}"'" },
            "properties": {
              "Nom": {
                "title": [
                  { "text": { "content": "Carte test - '"$(date +'%Y-%m-%d %H:%M')"'" } }
                ]
              }
            },
            "children": [
              {
                "object": "block",
                "type": "paragraph",
                "paragraph": {
                  "rich_text": [
                    { "type": "text", "text": { "content": "Hello Notion ðŸ‘‹ ceci est un test depuis GitHub Action" } }
                  ]
                }
              }
            ]
          }'
